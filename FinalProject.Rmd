---
title: "Police Shooting Fatalities in the United States"
author: "Neha Gyawali"
date: "4/26/2022"
output: slidy_presentation
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```
## Introduction
\ Unnecessary violence employed by many police officers throughout the US is an issue that needs to be addressed and dealt with. Recently, police fatalities have been highlighted in the media for their often unjust natures. Black men especially seem to be more targeted than the rest of the population. Let's take a look at police fatalities data that has been gathered by the Washington Post starting from 2015 to now to help us understand what demographic is at risk. We will take a look at the top 25 most fatal cities and break down the fatalities by race. We will also compare the race breakdown of the fatalities to the race breakdown of the population of the cities. For this we will use census data obtained from https://www.statsamerica.org/town/ that givs us demographic data for US cities. 
---
## Package Installation
```{r, warning=FALSE}
#install.packages("usmap")


# Load tidyverse to manipulate data
# Load usmap to make plot
# Load ggplot2 and plotly for graphing,

library(tidyverse, warn.conflicts = F)
options(tidyverse.quiet = TRUE)
library(usmap, warn.conflicts = F)
library(ggplot2, warn.conflicts = F)
library(plotly, warn.conflicts = F)

#read data
data <- read_csv("fatal-police-shootings-data.csv")
top25 <- read_csv("top25.csv")
top25 <- top25[1:25,]
top25 <- top25[,1:8]
```

## Gender Breakdown
\ Here we can see the difference in the number of female versus male fatalities. This helps us understand the demographic that is in danger of being killed by a police officer. \ 
```{r}

genderBreakdown <- data %>% group_by(gender) %>%  summarise(count = n())

gender <- c(327, 6913)
color =  c("mistyrose", "lightblue")
pie( gender, labels = c("4.5%", "95.48%"), col = color)
legend("topright", legend = c("Female", "Male"),
       fill =  c("mistyrose", "lightblue"))
title("Gender Breakdown of Police Fatalities")
```
\ When looking at this breakdown, we can tell that males are much more likely to die from a police fatality than women. 

## Race Breakdown Throughout the United States
```{r}
raceBreakdown <- data %>% group_by(race) %>%  summarise(count = n())
raceBreakdown
raceBreakdown2 <- c(1.44, 21.9, 15.2, 1.3, 0.3, 19.5, 6.16)
color = c("navyblue", "red4", "cadetblue4", "darkolivegreen", "darkviolet", "royalblue", "lavenderblush4")
pie( raceBreakdown2, labels = c("1.44%", "21.9%", "15.2%", "1.3%", "0.3%", "19.5%", "6.16%"), col = color)
legend("left", inset = 0, legend = c("Asian", "Black", "Hispanic", "Native American", "Other", "White", "NA"), fill = color)
title("Race Breakdown of Police Fatalities")

#data from census.gov
populationBreakdown <- c(5.9, 13.4, 18.5, 1.3, 3.0, 60.1)
pie( populationBreakdown, labels = c("5.9%", "13.4%", "18.5%", "1.3%", "3.0%", "60.1%"), col = color)
legend("left",inset = 5, legend = c("Asian", "Black", "Hispanic", "Native American", "Other", "White"), fill = color)
title("Race Breakdown of US Population")


legend("left", legend = c("Asian", "Black", "Hispanic", "Native American", "Other", "White"), fill = color)
```

\ These race breakdown charts show that the race breakdown of police fatalities are not proportional to the race breakdown of the United States as a whole. White people make up 60% of the population while they are only 20% of the fatalities. While Black people make up 13.4% of the population and are 21.9% of all fatalities. Hispanic people are


## Police Fatalities 

Some text about this table and how interesting the results are! 

```{r}
lat_long <- data %>% select(longitude, latitude, race, name, date, manner_of_death, armed, age, city, flee) %>% rename(lat = latitude, lon = longitude)
lat_long <- na.omit(lat_long)

transformed_lat_long <- usmap_transform(lat_long)

p <- plot_usmap(regions = "states") + geom_point(data = transformed_lat_long, aes(x = x, y=y, color =race, text = paste("Name: ", name, "\nArmed: ", armed, "\nAge: ", age, "\nCity: ", city, "\nManner of Death: ", manner_of_death, "\nDate: ", date, "\nFleeing: ", flee )), alpha = .05, position = "jitter")  + scale_color_manual(values = c("Asian" = "navyblue",  "Hispanic" = "cadetblue4", "Native American" = "darkolivegreen", "Other" = "darkviolet", "White"= "royalblue", "Black" = "red4"))+ labs(title = "Police Fatalities Locations")  + theme(panel.background=element_blank()) 

p <- ggplotly(p) 
p
```

## Race Breakdown of Police Fatalities in the top 25 Most Fatal Cities

```{r}
#find cities with most fatalities
numberfatalities <- data %>% group_by(city) %>%  summarise(count = n()) %>%  arrange(desc(count))


#take top 30 most fatal cities
mostDeaths <- numberfatalities[1:25,]

topdeadliestBreakdown <- merge(data, mostDeaths)


#graph with race breakdown
d <- ggplot(data = topdeadliestBreakdown, aes(x = reorder(city, city, function(x)-length(x)), fill = race)) + geom_bar() + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) + ggtitle("Race Breakdown with Fatality Count") + ylab("Fatality Count") + xlab("City") + labs(fill = "Race")  +scale_fill_manual(values = c("Asian" = "navyblue",  "Hispanic" = "cadetblue4", "Native American" = "darkolivegreen", "Other" = "darkviolet", "White"= "royalblue", "Black" = "red4", "NA" = "lavenderblush4"))
d
```

```{r}
d <- ggplot(data = topdeadliestBreakdown, aes(x = reorder(city, city, function(x)-length(x)), fill = race)) + geom_bar(position = "fill") + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) + labs(title = "Race Breakdown with Proportions", fill = "Race")+ xlab("City") + ylab("Proportion") +scale_fill_manual(values = c("Asian" = "navyblue",  "Hispanic" = "cadetblue4", "Native American" = "darkolivegreen", "Other" = "darkviolet", "White"= "royalblue", "Black" = "red4", "NA" = "lavenderblush4"))
d
```

\ Using these graphs we can see the top 25 cities with the most police fatalities. The first graph shows us the race breakdown in numbers and the second one shows us the race breakdown in percentage. We can see that in cities such as Chicago, Columbus, New York City, St.Louis, Atlanta, Louisville, and Philadelphia, Black people make up more than 50% of fatalities. Lets now look at the population breakdown of these cities to see they are proportional. 

```{r}

```
---
```{r}
data4 <- data  %>% mutate(date = (as.Date(date, "%m/%d/%Y"))) %>%  group_by(date)%>% mutate(count = n())
data4


m <- ggplot(data4, aes(x=date, y=count)) +geom_line()
m
```
 
